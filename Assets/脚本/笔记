# Unity游戏内菜单创建步骤

## 1. 创建UI基础结构

1. **打开Unity项目**：确保已打开 `d:\mygame\demo2` 项目
2. **进入游戏场景**：打开游戏场景（假设名为 "1"）
3. **创建Canvas**：
   - 在Hierarchy面板中右键 → UI → Canvas
   - 保留默认设置（Render Mode: Screen Space - Overlay）
4. **创建事件系统**：
   - 在Hierarchy面板中右键 → UI → Event System
   - 这将自动添加必要的组件

## 2. 创建游戏内菜单面板

### 2.1 创建主菜单面板
1. **创建面板**：在Canvas下右键 → UI → Panel，命名为 `InGameMenuPanel`
2. **设置面板**：
   - 调整大小覆盖整个屏幕
   - 设置背景颜色为半透明黑色（RGBA: 0, 0, 0, 0.7）
3. **添加标题**：在面板下创建Text，命名为 `MenuTitle`，文本设为 "游戏菜单"
4. **添加按钮**：在面板下创建5个Button：
   - 命名为 `BackToMainButton`，文本设为 "回到主菜单"
   - 命名为 `SaveButton`，文本设为 "存档"
   - 命名为 `LoadButton`，文本设为 "读档"
   - 命名为 `SettingsButton`，文本设为 "系统设置"
   - 命名为 `ExitGameButton`，文本设为 "退出游戏"
5. **排列按钮**：使用RectTransform调整按钮位置，使其整齐排列

### 2.2 创建存档菜单面板
1. **创建面板**：在Canvas下创建Panel，命名为 `SaveMenuPanel`
2. **设置面板**：
   - 大小与主菜单面板相同
   - 背景颜色与主菜单面板相同
3. **添加标题**：创建Text，命名为 `SaveTitle`，文本设为 "存档"
4. **添加返回按钮**：创建Button，命名为 `BackFromSaveButton`，文本设为 "返回"
5. **创建存档槽位**：
   - 为3个存档槽位各创建一个Button和一个Text：
     - 按钮命名为 `SaveButton1`, `SaveButton2`, `SaveButton3`
     - 文本命名为 `SaveInfoText1`, `SaveInfoText2`, `SaveInfoText3`
   - 文本初始内容设为 "存档槽位 X\n空存档"
6. **排列元素**：调整位置使界面整洁

### 2.3 创建读档菜单面板
1. **复制存档面板**：复制 `SaveMenuPanel` 并粘贴到Canvas下
2. **重命名面板**：将新面板命名为 `LoadMenuPanel`
3. **更新标题**：将标题文本改为 "读档"
4. **更新返回按钮**：将返回按钮命名为 `BackFromLoadButton`
5. **更新槽位元素**：
   - 按钮重命名为 `LoadButton1`, `LoadButton2`, `LoadButton3`
   - 文本重命名为 `LoadInfoText1`, `LoadInfoText2`, `LoadInfoText3`

### 2.4 创建设置菜单面板
1. **创建面板**：在Canvas下创建Panel，命名为 `SettingsPanel`
2. **设置面板**：
   - 大小与主菜单面板相同
   - 背景颜色与主菜单面板相同
3. **添加标题**：创建Text，命名为 `SettingsTitle`，文本设为 "系统设置"
4. **添加返回按钮**：创建Button，命名为 `BackFromSettingsButton`，文本设为 "返回"
5. **添加音效设置**：
   - 创建Toggle，命名为 `SoundToggle`
   - 在Toggle下创建Text，文本设为 "音效"
6. **添加音乐设置**：
   - 创建Toggle，命名为 `MusicToggle`
   - 在Toggle下创建Text，文本设为 "音乐"
7. **添加应用按钮**：创建Button，命名为 `ApplySettingsButton`，文本设为 "应用设置"
8. **排列元素**：调整位置使界面整洁

## 3. 创建音频源

1. **创建音频管理器**：在Hierarchy中创建空对象，命名为 `AudioManager`
2. **添加音效源**：
   - 选择AudioManager → 点击Add Component → Audio → Audio Source
   - 命名为 `SoundEffectSource`（通过Inspector的Name字段）
   - 取消勾选 Play On Awake 和 Loop
3. **添加音乐源**：
   - 再次点击Add Component → Audio → Audio Source
   - 命名为 `MusicSource`
   - 勾选 Play On Awake 和 Loop
   - （可选）将背景音乐拖拽到 Audio Clip 字段

## 4. 创建菜单管理器

1. **创建空对象**：在Hierarchy中创建空对象，命名为 `MenuManager`
2. **添加脚本**：
   - 将 `MenuManager.cs` 脚本拖拽到MenuManager对象上
   - 或者点击Add Component → 搜索 "MenuManager" 并添加

## 5. 配置MenuManager脚本

在Inspector面板中，为MenuManager脚本分配所有UI元素：

### 5.1 游戏内菜单
- **In Game Menu Panel**: 拖拽 `InGameMenuPanel`
- **Back To Main Button**: 拖拽 `BackToMainButton`
- **Save Button**: 拖拽 `SaveButton`
- **Load Button**: 拖拽 `LoadButton`
- **Settings Button**: 拖拽 `SettingsButton`
- **Exit Game Button**: 拖拽 `ExitGameButton`

### 5.2 存档菜单
- **Save Menu Panel**: 拖拽 `SaveMenuPanel`
- **Save Buttons**: 点击 "+" 三次，依次拖拽 `SaveButton1`, `SaveButton2`, `SaveButton3`
- **Save Info Texts**: 点击 "+" 三次，依次拖拽 `SaveInfoText1`, `SaveInfoText2`, `SaveInfoText3`
- **Back From Save Button**: 拖拽 `BackFromSaveButton`

### 5.3 读档菜单
- **Load Menu Panel**: 拖拽 `LoadMenuPanel`
- **Load Buttons**: 点击 "+" 三次，依次拖拽 `LoadButton1`, `LoadButton2`, `LoadButton3`
- **Load Info Texts**: 点击 "+" 三次，依次拖拽 `LoadInfoText1`, `LoadInfoText2`, `LoadInfoText3`
- **Back From Load Button**: 拖拽 `BackFromLoadButton`

### 5.4 系统设置
- **Settings Panel**: 拖拽 `SettingsPanel`
- **Sound Toggle**: 拖拽 `SoundToggle`
- **Music Toggle**: 拖拽 `MusicToggle`
- **Apply Settings Button**: 拖拽 `ApplySettingsButton`
- **Back From Settings Button**: 拖拽 `BackFromSettingsButton`

### 5.5 音频管理
- **Sound Effect Source**: 拖拽 `SoundEffectSource`
- **Music Source**: 拖拽 `MusicSource`

## 6. 设置菜单显示/隐藏逻辑

1. **创建空对象**：在Hierarchy中创建空对象，命名为 `MenuToggle`
2. **添加脚本**：创建新脚本 `MenuToggle.cs` 并添加到该对象
3. **编写脚本**：
```csharp
using UnityEngine;

public class MenuToggle : MonoBehaviour
{
    public MenuManager menuManager;
    public KeyCode menuKey = KeyCode.Escape; // 可以修改为其他键
    
    void Update()
    {
        if (Input.GetKeyDown(menuKey))
        {
            // 如果菜单未显示，则显示
            if (!menuManager.inGameMenuPanel.activeSelf && 
                !menuManager.saveMenuPanel.activeSelf && 
                !menuManager.loadMenuPanel.activeSelf && 
                !menuManager.settingsPanel.activeSelf)
            {
                menuManager.ShowInGameMenu();
                Time.timeScale = 0; // 暂停游戏
            }
            // 否则隐藏所有菜单
            else
            {
                menuManager.HideAllPanels();
                Time.timeScale = 1; // 恢复游戏
            }
        }
    }
}
```
4. **配置脚本**：将MenuManager对象拖拽到 `menuManager` 字段

## 7. 隐藏初始菜单面板

在Inspector面板中，取消勾选以下面板的 **Active Self** 选项：
- `InGameMenuPanel`
- `SaveMenuPanel`
- `LoadMenuPanel`
- `SettingsPanel`

## 8. 测试菜单功能

1. **运行游戏**：点击Unity编辑器的Play按钮
2. **打开菜单**：按Escape键（或您设置的菜单键）
3. **测试功能**：
   - 点击 "回到主菜单"：应返回主菜单场景
   - 点击 "存档"：应显示存档菜单
   - 点击 "读档"：应显示读档菜单
   - 点击 "系统设置"：应显示设置菜单
   - 点击 "退出游戏"：应退出游戏

## 9. 添加菜单图标（可选）

为了增强视觉效果，您可以为按钮添加自定义图标：
1. **准备图标**：确保您有菜单所需的图标文件（PNG格式）
2. **导入图标**：将图标拖拽到Assets文件夹
3. **设置图标**：
   - 选择按钮 → 在Inspector中展开Image组件
   - 将图标拖拽到Source Image字段
   - 调整Image的Position和Scale以合适显示

## 10. 优化和调整

1. **调整字体大小**：根据需要调整所有文本的字体大小
2. **调整按钮样式**：修改按钮的Transition效果和颜色
3. **添加动画**：为菜单面板添加淡入淡出效果（使用Animator）
4. **优化布局**：确保在不同屏幕分辨率下菜单都能正常显示

---

**注意**：确保MenuToggle.cs脚本能够访问MenuManager的HideAllPanels方法。如果该方法不存在，请在MenuManager.cs中添加：
```csharp
// 隐藏所有菜单面板
public void HideAllPanels()
{
    if (inGameMenuPanel != null) inGameMenuPanel.SetActive(false);
    if (saveMenuPanel != null) saveMenuPanel.SetActive(false);
    if (loadMenuPanel != null) loadMenuPanel.SetActive(false);
    if (settingsPanel != null) settingsPanel.SetActive(false);
}
```